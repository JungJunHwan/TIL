# TCP 3-way handshake & 4-way handshake

## TCP 3-way Handshake (연결 설정)

데이터를 전송하기 전, 양쪽 장치(클라이언트와 서버)가 서로 통신할 준비가 되었는지 확인하는 과정

1. SYN (서버에 물어봄)
    - 클라이언트가 서버에 접속을 요청하는 패킷을 보낸다
    - 이때 클라이언트는 임의의 시퀀스 번호를 보낸다
2. SYN + ACK (서버가 응답함)
    - 서버가 요청을 받고 답한다
    - 승인(ACK)와 동시에 본인의 접속 요청(SYN)을 보냅니다
3. ACK (클라도 응답함)
    - 클라이언트가 서버의 응답을 확인하고, 마지막 승인 패킷을 보낸다

이 과정을 통해 양방향 통신이 가능한지 확인하고, 앞으로 주고받을 데이터의 번호(Sequence Number)를 맞추게 된다

## TCP 4-way Handshake (연결 종료)

데이터 전송이 끝나면 연결을 끊어야 하는데 TCP는 양방향 통신이기 때문에, 양쪽의 연결을 각각 한 번씩 총 두 번 끊어줘야 해서 4단계가 필요하다

1. FIN (클라 송신 중단)
    - 클라이언트가 서버에 데이터를 다 보냈으니 연결을 끊겠다라는 메시지를 보낸다
2. ACK (서버 응답)
    - 서버는 일단 알겠는데 아직 내가 보낼게 남았을 수 있으니 기다리라는 메시지를 보낸다
3. FIN (서버 송신 중단)
    - 서버도 보낼 데이터를 다 보냈다면 연결 끊겠다라는 메시지를 보낸다
3. ACK (클라 응답)
    - 클라이언트가 마지막으로 확인했다고 응답하며 최종적으로 연결이 종료된다